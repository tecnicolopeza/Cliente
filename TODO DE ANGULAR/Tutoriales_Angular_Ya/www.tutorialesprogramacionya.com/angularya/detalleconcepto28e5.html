
<!DOCTYPE html>
<html>


<!-- Mirrored from www.tutorialesprogramacionya.com/angularya/detalleconcepto.php?punto=7&codigo=7&inicio=0 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 31 Jan 2022 19:06:08 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-4669394804436935",
    enable_page_level_ads: true
  });
</script>

<title>Directiva ngModel</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">    
<meta name="keywords" content="Angular, programación, tutorial">
<meta name="description" content="El objetivo de este tutorial 
es presentar los conceptos básicos del framework Angular">
<meta name="author" content="Diego Moisset">


<link href="../css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="estilos.css">

<style>
html,body {
	background-color: #D3E9D0;
	font-family: sans-serif,arial;

}
</style>

<style>
.uno { width: 320px; height: 100px; }
@media(min-width: 500px) { .uno { width: 320px; height: 100px; } }
@media(min-width: 800px) { .uno { width: 336px; height: 280px; } }

.dos { width: 320px; height: 100px; }
@media(min-width: 500px) { .dos { width: 320px; height: 100px; } }
@media(min-width: 800px) { .dos { width: 336px; height: 280px; } }
</style>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-80268657-1', 'auto');
  ga('send', 'pageview');

</script>

</head>

<body>


<div class="container">

<div class="row">
  <div class="col-md-12">

<div class="titulodetalle">
<h1>7 - Directiva ngModel</h1></div>

  </div>
</div>  


<div class="row">
  <div class="col-md-12">

<div class="cuerpodetalle">
<div style="display:block;float:left;margin: 5px;"> 
 <script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
<!-- adaptable1 -->
<ins class="adsbygoogle uno"
     style="display:inline-block"
     data-ad-client="ca-pub-4669394804436935"
     data-ad-slot="4716538363"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script> 
</div> 


<p>Esta directiva nos permite tener un enlace unidireccional entre una propiedad de nuestra clase con el valor que se muestra un control de formulario HTML de tipo input, textarea etc.</p>
<p>Por ejemplo si en la clase AppComponent tenemos la propiedad 'nombre' con el valor 'juan':</p>
<pre>
nombre='juan';
</pre>
<p>Luego en la vista definimos la directiva ngModel entre corchetes y le asignamos el nombre de la propiedad definida en la clase:</p>
<pre>
  &lt;input type="text" [ngModel]="nombre"&gt;
</pre>
<p>Cuando arrancamos la aplicación podemos observar que el control input aparece automáticamente con el valor 'juan':</p>
<img src="imagentema/foto018.jpg" border="0" alt="ngModel"><br>
<p>Lo que hay que tener en cuenta que es un enlace en una única dirección: el valor de la propiedad de la clase se refleja en la interfaz visual. Si el operador cambia el contenido del control 'input' por ejemplo por el nombre 'ana' luego la propiedad 'nombre' de la clase sigue almacenando el valor 'juan'.</p>
<p>Si queremos que el enlace sea en las dos direcciones debemos utilizar la siguiente sintaxis:</p>
<pre>
&lt;input type="text" [(ngModel)]="nombre"&gt;
</pre>

<p>Un primer ejemplo muy corto que podemos hacer es modificar el proyecto001 para que se ingrese el nombre y apellido de una persona y se muestre inmediatamente en la parte inferior.</p>
<p>Cuando utilizamos la directiva ngModel debemos importar la clase 'FormsModule' en el archivo 'app.module.ts' y especificarla en la propiedad 'imports':</p>
<pre class="recuadro">
import { BrowserModule } from '@angular/platform-browser';
import { NgModule } from '@angular/core';
<strong>import {FormsModule} from '@angular/forms';</strong>

import { AppComponent } from './app.component';

@NgModule({
  declarations: [
    AppComponent
  ],
  imports: [
    BrowserModule
<strong>    ,FormsModule</strong>
  ],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule { }
</pre>

<p>Luego nuestro archivo 'app.component.ts' debe tener:</p>
<pre class="recuadro">
import { Component } from '@angular/core';

@Component({
  selector: 'app-root',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.css']
})
export class AppComponent {
  nombre='';
  apellido='';
}
</pre>
<p>El archivo app.component.html donde definimos las directiva ngModel para cada control es:</p>
<pre class="recuadro">
&lt;div&gt;
  &lt;p&gt;Ingrese nombre&lt;input type="text" [(ngModel)]="nombre"&gt;&lt;/p&gt;
  &lt;p&gt;Ingrese apellido&lt;input type="text" [(ngModel)]="apellido"&gt;&lt;/p&gt;  
  &lt;p&gt;Nombre completo:{{nombre}},{{apellido}}&lt;/p&gt;
&lt;/div&gt;
</pre>

<p>Ejecutemos nuestra aplicación desde la línea de comandos de Node.js:</p>
<img src="imagentema/foto005.jpg" alt="ejecución de proyecto en Angular" border="0"><br>
<p>En el navegador nos muestra como se actualizan las propiedades cada vez que ingresamos un caracter en los controles 'input':</p>
<img src="imagentema/foto019.jpg" border="0" alt="evento click button angular"><br>


<h3>Problema</h3>
<p>Confeccionar una aplicación que permita administrar un vector de objetos que almacena en cada elemento el código, descripción y precio de un artículo. Se debe poder agregar, borrar y modificar los datos de un artículo.</p>
<p>La interfaz visual de la aplicación debe ser similar a esta:</p>
<img src="imagentema/foto021.jpg" border="0" alt="proyecto de altas, bajas y modificaciones en angular"><br>
<p>Crearemos nuestro segundo proyecto para resolver este problema.</p>
<ol>
<li>
Lo primero que debemos hacer es desde la línea de comandos de Node.js proceder a crear el proyecto002:</p>
<pre>
ng new proyecto002
</pre>
<img src="imagentema/foto020.jpg" border="0" alt="crear proyecto en angular"><br>
<p>Tener en cuenta en que directorio estamos posicionados ya que a partir de ese se crea la carpeta con el proyecto completo.</p>
<p>Si estamos utilizando el editor VS Code proceder a elegir la opción Archivo -> Abrir carpeta... y seleccionamos 'proyecto002'.</p>
</li>

<li>
<p>Como trabajaremos con un formulario donde el operador ingresará el código, descripción y precio de productos lo más conveniente es enlazar los controles 'input' mediante la directiva 'ngModel'. Debemos entonces importar la clase 'FormsModule' en el archivo 'app.module.ts':</p>
<pre class="recuadro">
import { BrowserModule } from '@angular/platform-browser';
import { NgModule } from '@angular/core';
<strong>import { FormsModule } from '@angular/forms';</strong>

import { AppComponent } from './app.component';


@NgModule({
  declarations: [
    AppComponent
  ],
  imports: [
    BrowserModule
<strong>    , FormsModule</strong>
  ],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule { }

</pre>
</li>

<li>
<p>En el archivo app.component.html implementamos:</p>
<pre class="recuadro">
&lt;div&gt;
  &lt;h1&gt;Administración de artículos&lt;/h1&gt;
    &lt;table border="1" *ngIf="hayRegistros(); else sinarticulos"&gt;
      &lt;tr&gt;
        &lt;td&gt;Codigo&lt;/td&gt;&lt;td&gt;Descripcion&lt;/td&gt;&lt;td&gt;Precio&lt;/td&gt;&lt;td&gt;Borrar&lt;/td&gt;&lt;td&gt;Seleccionar&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr *ngFor="let art of articulos"&gt;
        &lt;td&gt;{{art.codigo}}&lt;/td&gt;
        &lt;td&gt;{{art.descripcion}}&lt;/td&gt;
        &lt;td&gt;{{art.precio}}&lt;/td&gt;
        &lt;td&gt;&lt;button (click)="borrar(art.codigo)"&gt;Borrar?&lt;/button&gt;&lt;/td&gt;
        &lt;td&gt;&lt;button (click)="seleccionar(art)"&gt;Seleccionar&lt;/button&gt;&lt;/td&gt;        
      &lt;/tr&gt;
    &lt;/table&gt;
    &lt;ng-template #sinarticulos&gt;&lt;p&gt;No hay articulos.&lt;/p&gt;&lt;/ng-template&gt;
    &lt;div&gt;
      &lt;p&gt;
        Codigo:&lt;input type="number" [(ngModel)]="art.codigo" /&gt;
      &lt;/p&gt;
      &lt;p&gt;
        descripcion:&lt;input type="text" [(ngModel)]="art.descripcion" /&gt;
      &lt;/p&gt;
      &lt;p&gt;
        precio:&lt;input type="number" [(ngModel)]="art.precio" /&gt;
      &lt;/p&gt;            
      &lt;p&gt;&lt;button (click)="agregar()"&gt;Agregar&lt;/button&gt;
      &lt;button (click)="modificar()"&gt;Modificar&lt;/button&gt;&lt;/p&gt;
    &lt;/div&gt;
&lt;/div&gt;
</pre>
</li>

<li>
<p>La clase app.component.ts es:</p>
<pre class="recuadro">
import { Component } from '@angular/core';

@Component({
  selector: 'app-root',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.css']
})
export class AppComponent {
  
  art={
    codigo:0 ,
    descripcion:"",
    precio:0
  }

  articulos = [{codigo:1, descripcion:'papas', precio:10.55},
               {codigo:2, descripcion:'manzanas', precio:12.10},
               {codigo:3, descripcion:'melon', precio:52.30},
               {codigo:4, descripcion:'cebollas', precio:17},
               {codigo:5, descripcion:'calabaza', precio:20},
              ];

  hayRegistros() {
    return this.articulos.length&gt;0;              
  }

  borrar(codigo:number) {
    for(let x=0;x&lt;this.articulos.length;x++)
      if (this.articulos[x].codigo==codigo)
      {
        this.articulos.splice(x,1);
        return;
      }
  }

  agregar() {
    if (this.art.codigo==0) {
      alert('Debe ingresar un código de articulo distinto a cero');
      return;
    }
    for(let x=0;x&lt;this.articulos.length;x++)
    if (this.articulos[x].codigo==this.art.codigo)
    {
      alert('ya existe un articulo con dicho codigo');
      return;
    }        
    this.articulos.push({codigo:this.art.codigo,
                         descripcion:this.art.descripcion,
                         precio:this.art.precio });
    this.art.codigo=0;
    this.art.descripcion="";	
    this.art.precio=0;    
  }

  seleccionar(art: { codigo: number; descripcion: string; precio: number; }) {
    this.art.codigo=art.codigo;
    this.art.descripcion=art.descripcion;
    this.art.precio=art.precio;
  }

  modificar() {
    for(let x=0;x&lt;this.articulos.length;x++)
      if (this.articulos[x].codigo==this.art.codigo)
      {
        this.articulos[x].descripcion=this.art.descripcion;
        this.articulos[x].precio=this.art.precio;
        return;
      }        
    alert('No existe el código de articulo ingresado');
  }
}
</pre>
</li>

<li>
<p>Ejecutemos la aplicación desde la ventana de Node.js mediante el comando:</p>
<pre>
ng serve -o
</pre>
<p>Debemos estar en la carpeta donde se localiza nuestro proyecto:</p>
<img src="imagentema/foto022.jpg" border="0" alt="ejecutar proyecto angular"><br>
</li>

</ol>
<h3>Listado</h3>
<p>Pasemos a analizar las distintas partes de nuestra aplicación. Los archivos app.component.ts y app.component.html están totalmente integrados y con objetivos bien definidos cada uno. El archivo '.html' almacena la vista y el archivo '.ts' almacena el modelo de datos.</p>
<p>Definimos en el modelo (app.component.ts) un vector de objetos llamado 'articulos' y almacenamos 5 elementos:</p>
<pre>
  articulos = [{codigo:1, descripcion:'papas', precio:10.55},
               {codigo:2, descripcion:'manzanas', precio:12.10},
               {codigo:3, descripcion:'melon', precio:52.30},
               {codigo:4, descripcion:'cebollas', precio:17},
               {codigo:5, descripcion:'calabaza', precio:20},
              ];
</pre>
<p>En la vista (app.component.html) generamos una tabla HTML que muestre los datos del modelo y lo recorremos mediante la directiva *ngFor:</p>
<pre>
    &lt;table border="1" *ngIf="hayRegistros(); else sinarticulos"&gt;
      &lt;tr&gt;
        &lt;td&gt;Codigo&lt;/td&gt;&lt;td&gt;Descripcion&lt;/td&gt;&lt;td&gt;Precio&lt;/td&gt;&lt;td&gt;Borrar&lt;/td&gt;&lt;td&gt;Seleccionar&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr *ngFor="let art of articulos"&gt;
        &lt;td&gt;{{art.codigo}}&lt;/td&gt;
        &lt;td&gt;{{art.descripcion}}&lt;/td&gt;
        &lt;td&gt;{{art.precio}}&lt;/td&gt;
        &lt;td&gt;&lt;button (click)="borrar(art.codigo)"&gt;Borrar?&lt;/button&gt;&lt;/td&gt;
        &lt;td&gt;&lt;button (click)="seleccionar(art)"&gt;Seleccionar&lt;/button&gt;&lt;/td&gt;        
      &lt;/tr&gt;
    &lt;/table&gt;
</pre>
<p>Disponemos en cada fila dos botones y definimos sus respectivos eventos 'click' para que al ser presionados llamen a métodos del modelo para borrar o seleccionar el artículo respectivo. Los métodos envían como parámetro el artículo para saber cual borrar o seleccionar.</p>
<p>En la vista disponemos una serie de 'input' que nos permiten ingresar el código, descripción y precio de un artículo:</p>
<pre>
&lt;div&gt;
      &lt;p&gt;
        Codigo:&lt;input type="number" [(ngModel)]="art.codigo" /&gt;
      &lt;/p&gt;
      &lt;p&gt;
        descripcion:&lt;input type="text" [(ngModel)]="art.descripcion" /&gt;
      &lt;/p&gt;
      &lt;p&gt;
        precio:&lt;input type="number" [(ngModel)]="art.precio" /&gt;
      &lt;/p&gt;            
      &lt;p&gt;&lt;button (click)="agregar()"&gt;Agregar&lt;/button&gt;
      &lt;button (click)="modificar()"&gt;Modificar&lt;/button&gt;&lt;/p&gt;
    &lt;/div&gt;
</pre>
<h3>Agregado</h3>
<p>Podemos comprobar que los controles HTML tienen la directiva 'ngModel' bidireccional, es decir que cuando el operador carga un dato en el primer 'input' se actualiza automáticamente en el modelo el dato cargado en 'art.codigo':</p>
<p>Podemos comprobar que en el modelo tenemos definido un objeto llamado art con tres propiedes:</p>
<pre>
  art={
    codigo:0 ,
    descripcion:"",
    precio:0
  }
</pre>

<p>Al presionar el botón agregar se ejecuta el método 'agregar':</p>
<pre>
  agregar() {
    if (this.art.codigo==0) {
      alert('Debe ingresar un código de articulo distinto a cero');
      return;
    }
    for(let x=0;x&lt;this.articulos.length;x++)
    if (this.articulos[x].codigo==this.art.codigo)
    {
      alert('ya existe un articulo con dicho codigo');
      return;
    }        
    this.articulos.push({codigo:this.art.codigo,
                         descripcion:this.art.descripcion,
                         precio:this.art.precio });
    this.art.codigo=0;
    this.art.descripcion="";	
    this.art.precio=0;    
  }
</pre>
<p>En este método primero recorremos el vector articulos para comprobar si hay algún otro artículo con el mismo código. En el caso que no exista procedemos a añadir un nuevo elemento llamando al método push y pasando un objeto que creamos en dicho momento con los datos almacenados en el objeto 'art' que se encuentra enlazado con el formulario.</p>
<p>Luego asignamos cero y cadena vacía a todas las propiedades del objeto art con el objetivo de borrar todos los 'input' del formulario.</p>
<p>Al agregar un elemento al vector 'Angular' se encarga de actualizar la vista sin tener que indicar nada en nuestro código.</p>
<h3>Borrado</h3>
<p>Cuando se presiona el botón de borrar se ejecuta el método 'borrar':</p>
<pre>
  borrar(codigo:number) {
    for(let x=0;x&lt;this.articulos.length;x++)
      if (this.articulos[x].codigo==codigo)
      {
        this.articulos.splice(x,1);
        return;
      }
  }
</pre>
<p>Recorremos el vector y controlamos uno a uno el código del artículo seleccionado con cada uno de los elementos del vector. El que coincide lo eliminamos del vector llamando al método splice indicando la posición y cuantas componentes borrar a partir de ese.</p>

<h3>Selección</h3>
<p>Cuando se presiona el botón de seleccionar se ejecuta el método 'seleccionar':</p>
<pre>
  seleccionar(art: { codigo: number; descripcion: string; precio: number; }) {
    this.art.codigo=art.codigo;
    this.art.descripcion=art.descripcion;
    this.art.precio=art.precio;
  }
</pre>
<p>Lo único que hacemos es actualizar el objeto art del modelo con el artículo que acaba de seleccionar el operador (llega como parámetro el artículo seleccionado)</p>

<h3>Modificación</h3>
<p>Cuando presiona el botón de modificación se ejecuta el método:</p>
<pre>
  modificar() {
    for(let x=0;x&lt;this.articulos.length;x++)
      if (this.articulos[x].codigo==this.art.codigo)
      {
        this.articulos[x].descripcion=this.art.descripcion;
        this.articulos[x].precio=this.art.precio;
        return;
      }        
    alert('No existe el código de articulo ingresado');
  }
</pre>
<p>Buscamos el código de articulo del control 'input' dentro del vector, en caso de encontrarlo procedemos a modificar la descripción y precio.</p>

<p>Por último decir que hemos utilizado la directiva *ngIf para no mostrar la tabla HTML en caso que el vector 'articulos' se encuentre vacío:</p>
<pre>
    &lt;table border="1" *ngIf="hayRegistros(); else sinarticulos"&gt;
</pre>
<p>Llamamos al método 'hayRegistros()' que retorna true o false dependiendo si el vector tiene o no componentes:</p>
<pre>
  hayRegistros() {
    return this.articulos.length&gt;0;              
  }
</pre>

<p>Podemos probar esta aplicación en la web <a href="https://scratchya.com.ar/angular/proyecto002/" target="_blank">aquí</a>.</p><div class="botonretorno"><a href="index2904.html?inicio=0">Retornar</a></div> 

<div>
<!--publi-->
<script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
<!-- adaptable2 -->
<ins class="adsbygoogle dos"
     style="display:inline-block"
     data-ad-client="ca-pub-4669394804436935"
     data-ad-slot="5774469161"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!--publi-->
<script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
<!-- adaptable2 -->
<ins class="adsbygoogle dos"
     style="display:inline-block"
     data-ad-client="ca-pub-4669394804436935"
     data-ad-slot="5774469161"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

</div>




</div>

  </div>
</div>  

</div>

<script type="text/javascript">
function cambiar()
{
  var lista=document.getElementsByTagName('pre');
  for(f=0;f<lista.length;f++)
  {
   lista[f].style.display='block';
  }
  document.getElementById('solucion').style.display='none';
}

</script>

</body>


<!-- Mirrored from www.tutorialesprogramacionya.com/angularya/detalleconcepto.php?punto=7&codigo=7&inicio=0 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 31 Jan 2022 19:06:10 GMT -->
</html>
